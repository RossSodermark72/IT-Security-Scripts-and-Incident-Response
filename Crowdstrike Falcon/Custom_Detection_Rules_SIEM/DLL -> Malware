event_simpleName=FileWrite OR event_simpleName=FileCreation
| filter FileName matches_regex ".*\\.(exe|dll|sys)$"
| filter FilePath matches_regex "C:\\\\Windows\\\\Temp\\\\.*" OR FilePath matches_regex "C:\\\\Users\\\\.*\\\\AppData\\\\Local\\\\Temp\\\\.*"
| stats-count by FileName: FilePath: ComputerName: UserName:
| sort-count

// This query looks for executable, DLL, and system files being written or created in temporary directories, which is a common behavior for malware. You can adjust the file paths and file types based on your specific needs. --Ross Sodermark 4/2025
